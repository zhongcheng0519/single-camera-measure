# 单目视觉测量

*[English](README.md)*

## 简介

如今，手机的照相功能使我们能轻易地获取照片。尽管大多数人不会使用照相机进行测量，但在工程实践中，这实际上是一种非常实用的方法。这里介绍的单目视觉测量技术，使得我们可以方便地使用手机对特定平面进行测量。

这个项目基于 `OpenCV` 库，通过以下三个步骤实现单目视觉测量：

1. 使用棋盘格进行相机内参的校准；
2. 利用棋盘格获取相机的外参；（根据实际场景，也可以选取不同的方法来进行外参标定。）
3. 在步骤2拍摄的图片上选取线段，程序将显示该线段在现实世界中的尺寸。

## 使用方法

### 步骤一、内参校准

1. 从不同的角度用相机拍摄棋盘格，然后将图片放入 `train` 文件夹中。
2. 修改 `data/Calibration.toml` 文件中的 `chess_size`、`grid_length` 和 `image_size`。其中，`chess_size` 是棋盘格的格子数量，`grid_length` 是每个正方形格子的尺寸（单位为 `mm`），`image_size` 是图像的大小。
3. 运行 `train-intrinsic.py` 脚本。得到的内参结果将保存在 `data/Calibration.toml` 文件中。
4. 内参校准完成后，你可以在 `undistort-img` 文件夹中查看去畸变后的图像。如下图所示：

![undistort-image-example](undistort-image-example.png)

### 步骤二、外参标定

在 `test` 文件夹中放入一张包含棋盘格的图片。`measure-test.py` 脚本展示了如何进行外参标定。在此过程中，它还提取了棋盘格的角点，并将其转换到世界坐标系下，然后与已知的棋盘格世界坐标进行比对，以验证方法的有效性。

### 步骤三、测量

`measure.py` 脚本用于实际的测量。你可以在此脚本中选择一张图片，然后选择起点和终点，程序将计算并显示这两点之间的距离。

![measure](measure.png)

```bash
距离: 
[105.12268]
```